---
layout: post
title: "–°–≤–æ–π LLM-—á–∞—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã: –∑–∞–¥–∞—ë–º –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É, –∞ –Ω–µ –∫–æ–¥—É"
date: 2026-06-23
categories: ai llm chatbot trading
excerpt: "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —á–∞—Ç-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –±–∞–∑–µ LLM, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–Ω–∏–º–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∞—à–∏—Ö –ø–æ–∑–∏—Ü–∏–π, —Ä–∏—Å–∫–æ–≤ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –û—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∞—Ç–±–æ—Ç–∞ –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–µ–∞–ª-—Ç–∞–π–º –º–µ—Ç—Ä–∏–∫–∞–º."
---

# –°–≤–æ–π LLM-—á–∞—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã: –∑–∞–¥–∞—ë–º –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É, –∞ –Ω–µ –∫–æ–¥—É

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: –≤—ã –ø—Ä–æ—Å–Ω—É–ª–∏—Å—å –≤ 6 —É—Ç—Ä–∞, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –ø–∏—à–µ—Ç–µ: "–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –º–æ–∏–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏?" –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—Ç–≤–µ—Ç: "3 –ø–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç—ã. AAPL +$240 (20 –º–∏–Ω—É—Ç –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Ç–∞–∫–µ-–ø—Ä–æ—Ñ–∏—Ç—É), TSLA -$85 (—Å—Ç–æ–ø-–ª–æ—Å—Å —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ -$120), ES –æ–∂–∏–¥–∞–µ—Ç —Å–∏–≥–Ω–∞–ª. –û–±—â–∏–π P&L –∑–∞ –Ω–æ—á—å: +$312. –†–∏—Å–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã."

–≠—Ç–æ –Ω–µ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞. –í –∏—é–Ω–µ 2026 –≥–æ–¥–∞ —è —Å–æ–∑–¥–∞–ª LLM-—á–∞—Ç –¥–ª—è —Å–≤–æ–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ OSA Engine, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–º–µ–Ω–∏–ª –º–Ω–µ –ø–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ø–æ–ª–æ–≤–∏–Ω—É –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ ‚Äî –ø–æ—à–∞–≥–æ–≤—ã–π –≥–∞–π–¥, –∫–∞–∫ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å.

## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω LLM-—á–∞—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏

–î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —á–∞—Ç–∞ –º–æ–π –ø—Ä–æ—Ü–µ—Å—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤—ã–≥–ª—è–¥–µ–ª —Ç–∞–∫:

**–£—Ç—Ä–æ (6:00 AM):**
1. –û—Ç–∫—Ä—ã–≤–∞—é Grafana ‚Üí —Å–º–æ—Ç—Ä—é –¥–∞—à–±–æ—Ä–¥ "Overnight P&L"
2. –û—Ç–∫—Ä—ã–≤–∞—é Jupyter Notebook ‚Üí –∑–∞–ø—É—Å–∫–∞—é —Å–∫—Ä–∏–ø—Ç `check_positions.py`
3. –ß–∏—Ç–∞—é –ª–æ–≥–∏ ‚Üí –∏—â—É —Å—Ç—Ä–æ–∫–∏ —Å ERROR –∏–ª–∏ WARNING
4. –û—Ç–∫—Ä—ã–≤–∞—é Telegram ‚Üí –ø—Ä–æ–≤–µ—Ä—è—é –∞–ª–µ—Ä—Ç—ã –æ—Ç –±–æ—Ç–∞
5. –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é CSV-—Ñ–∞–π–ª —Å —Ç—Ä–µ–π–¥–∞–º–∏ –∑–∞ –Ω–æ—á—å
6. –í—Ä—É—á–Ω—É—é —Å—á–∏—Ç–∞—é —Ä–∏—Å–∫ –ø–æ –æ—Ç–∫—Ä—ã—Ç—ã–º –ø–æ–∑–∏—Ü–∏—è–º

**–í—Ä–µ–º—è:** 10-15 –º–∏–Ω—É—Ç –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞—à–±–æ—Ä–¥–∞.

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è LLM-—á–∞—Ç–∞:

**–£—Ç—Ä–æ (6:00 AM):**
1. –û—Ç–∫—Ä—ã–≤–∞—é Telegram
2. –ü–∏—à—É: "–°–≤–æ–¥–∫–∞ –∑–∞ –Ω–æ—á—å"
3. –ü–æ–ª—É—á–∞—é –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã

**–í—Ä–µ–º—è:** 30 —Å–µ–∫—É–Ω–¥

**–ë–æ–Ω—É—Å:** –ú–æ–≥—É –∑–∞–¥–∞—Ç—å –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞.

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1: –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —á–∞—Ç –Ω–∞ OpenAI API

–ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –±—ã–ª–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π:

```python
import openai
import json
from datetime import datetime
from typing import List, Dict
import pandas as pd


class TradingSystemChat:
    """
    –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —á–∞—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.
    """
    def __init__(self, api_key: str, db_path: str):
        self.client = openai.OpenAI(api_key=api_key)
        self.db_path = db_path
        self.conversation_history = []

    def get_positions(self) -> List[Dict]:
        """
        –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏.
        """
        # –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —ç—Ç–æ –∑–∞–ø—Ä–æ—Å –∫ –ë–î –∏–ª–∏ API –±—Ä–æ–∫–µ—Ä–∞
        # –ó–¥–µ—Å—å —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏–∑ CSV
        positions_df = pd.read_csv(f"{self.db_path}/positions.csv")
        open_positions = positions_df[positions_df['status'] == 'open']

        return open_positions.to_dict('records')

    def get_pnl_summary(self, period: str = 'today') -> Dict:
        """
        –ü–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–¥–∫—É –ø–æ –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞–º.
        """
        trades_df = pd.read_csv(f"{self.db_path}/trades.csv", parse_dates=['timestamp'])

        if period == 'today':
            today = datetime.now().date()
            trades = trades_df[trades_df['timestamp'].dt.date == today]
        elif period == 'week':
            week_ago = datetime.now() - pd.Timedelta(days=7)
            trades = trades_df[trades_df['timestamp'] >= week_ago]
        else:
            trades = trades_df

        return {
            'total_pnl': trades['pnl'].sum(),
            'num_trades': len(trades),
            'win_rate': (trades['pnl'] > 0).mean(),
            'avg_win': trades[trades['pnl'] > 0]['pnl'].mean(),
            'avg_loss': trades[trades['pnl'] < 0]['pnl'].mean(),
            'largest_win': trades['pnl'].max(),
            'largest_loss': trades['pnl'].min()
        }

    def get_system_status(self) -> Dict:
        """
        –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã.
        """
        # –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –∑–∞–ø—Ä–æ—Å –∫ API —Å–∏—Å—Ç–µ–º—ã
        return {
            'status': 'running',
            'uptime_hours': 72.5,
            'strategies_active': 3,
            'last_heartbeat': '2026-06-23 09:15:32',
            'errors_last_hour': 0
        }

    def create_context(self, user_question: str) -> str:
        """
        –°–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è LLM –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ø—Ä–æ—Å–∞.
        """
        # –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏
        positions = self.get_positions()
        pnl = self.get_pnl_summary('today')
        status = self.get_system_status()

        context = f"""–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (–Ω–∞ {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}):

–û–¢–ö–†–´–¢–´–ï –ü–û–ó–ò–¶–ò–ò:
{json.dumps(positions, indent=2, ensure_ascii=False)}

–ü–†–ò–ë–´–õ–¨/–£–ë–´–¢–ö–ò –ó–ê –°–ï–ì–û–î–ù–Ø:
{json.dumps(pnl, indent=2, ensure_ascii=False)}

–°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´:
{json.dumps(status, indent=2, ensure_ascii=False)}

–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {user_question}

–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ —Å—É—â–µ—Å—Ç–≤—É. –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤—ã—à–µ."""

        return context

    def ask(self, question: str) -> str:
        """
        –ó–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å LLM.
        """
        # –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–∫—Å—Ç
        context = self.create_context(question)

        # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        self.conversation_history.append({
            'role': 'user',
            'content': context
        })

        # –ó–∞–ø—Ä–æ—Å –∫ OpenAI
        response = self.client.chat.completions.create(
            model="gpt-4",
            messages=[
                {
                    'role': 'system',
                    'content': '–¢—ã ‚Äî –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Ç—Ä–µ–π–¥–µ—Ä–∞. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—à—å –¥–∞–Ω–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –æ—Ç–≤–µ—á–∞–µ—à—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫—Ä–∞—Ç–∫–æ –∏ —Ç–æ—á–Ω–æ.'
                }
            ] + self.conversation_history,
            temperature=0.3,
            max_tokens=500
        )

        answer = response.choices[0].message.content

        # –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é
        self.conversation_history.append({
            'role': 'assistant',
            'content': answer
        })

        return answer


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
if __name__ == "__main__":
    chat = TradingSystemChat(
        api_key="sk-...",
        db_path="./data"
    )

    # –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤
    questions = [
        "–ö–∞–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —É –º–µ–Ω—è –æ—Ç–∫—Ä—ã—Ç—ã?",
        "–°–∫–æ–ª—å–∫–æ —è –∑–∞—Ä–∞–±–æ—Ç–∞–ª —Å–µ–≥–æ–¥–Ω—è?",
        "–ö–∞–∫–∞—è –ø–æ–∑–∏—Ü–∏—è —Å–∞–º–∞—è –ø—Ä–∏–±—ã–ª—å–Ω–∞—è?",
        "–ï—Å—Ç—å –ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–∏—Å—Ç–µ–º–æ–π?"
    ]

    for q in questions:
        print(f"\n–í–æ–ø—Ä–æ—Å: {q}")
        answer = chat.ask(q)
        print(f"–û—Ç–≤–µ—Ç: {answer}")
```

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** (positions.csv):
```csv
symbol,side,quantity,entry_price,current_price,pnl,status,opened_at
AAPL,long,10,178.50,182.90,440.00,open,2026-06-23 08:15:00
TSLA,short,5,245.80,247.50,-85.00,open,2026-06-23 09:00:00
ES,long,2,5420.50,5420.50,0.00,open,2026-06-23 09:10:00
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**

```
–í–æ–ø—Ä–æ—Å: –ö–∞–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —É –º–µ–Ω—è –æ—Ç–∫—Ä—ã—Ç—ã?
–û—Ç–≤–µ—Ç: –£ –≤–∞—Å –æ—Ç–∫—Ä—ã—Ç—ã 3 –ø–æ–∑–∏—Ü–∏–∏:
1. AAPL: –ª–æ–Ω–≥, 10 –∞–∫—Ü–∏–π, –ø—Ä–∏–±—ã–ª—å +$440
2. TSLA: —à–æ—Ä—Ç, 5 –∞–∫—Ü–∏–π, —É–±—ã—Ç–æ–∫ -$85
3. ES: –ª–æ–Ω–≥, 2 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ($0)

–û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å –ø–æ –æ—Ç–∫—Ä—ã—Ç—ã–º –ø–æ–∑–∏—Ü–∏—è–º: +$355

–í–æ–ø—Ä–æ—Å: –°–∫–æ–ª—å–∫–æ —è –∑–∞—Ä–∞–±–æ—Ç–∞–ª —Å–µ–≥–æ–¥–Ω—è?
–û—Ç–≤–µ—Ç: –°–µ–≥–æ–¥–Ω—è –≤—ã —Å–æ–≤–µ—Ä—à–∏–ª–∏ 12 —Å–¥–µ–ª–æ–∫ —Å –æ–±—â–µ–π –ø—Ä–∏–±—ã–ª—å—é +$312. –í–∏–Ω—Ä–µ–π—Ç 67% (8 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö, 4 —É–±—ã—Ç–æ—á–Ω—ã—Ö). –°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ñ–∏—Ç –Ω–∞ —Å–¥–µ–ª–∫—É: +$26. –õ—É—á—à–∞—è —Å–¥–µ–ª–∫–∞: +$125, —Ö—É–¥—à–∞—è: -$78.

–í–æ–ø—Ä–æ—Å: –ö–∞–∫–∞—è –ø–æ–∑–∏—Ü–∏—è —Å–∞–º–∞—è –ø—Ä–∏–±—ã–ª—å–Ω–∞—è?
–û—Ç–≤–µ—Ç: –°–∞–º–∞—è –ø—Ä–∏–±—ã–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è ‚Äî AAPL —Å –ø—Ä–∏–±—ã–ª—å—é +$440. –¶–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞ —Å $178.50 –¥–æ $182.90 (+2.47%). –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ 1 —á–∞—Å –Ω–∞–∑–∞–¥.

–í–æ–ø—Ä–æ—Å: –ï—Å—Ç—å –ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–∏—Å—Ç–µ–º–æ–π?
–û—Ç–≤–µ—Ç: –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ. –°—Ç–∞—Ç—É—Å: running, –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã 72.5 —á–∞—Å–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤. –ê–∫—Ç–∏–≤–Ω—ã 3 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏. –ü–æ—Å–ª–µ–¥–Ω–∏–π heartbeat: 30 —Å–µ–∫—É–Ω–¥ –Ω–∞–∑–∞–¥. –û—à–∏–±–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å: 0.
```

**–í–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è:**
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞
- –û—Ç–≤–µ—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 2-4 —Å–µ–∫—É–Ω–¥—ã
- –°—Ç–æ–∏–º–æ—Å—Ç—å: ~$0.02 –Ω–∞ 4 –≤–æ–ø—Ä–æ—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ß–∞—Ç –Ω–µ —É–º–µ–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–π—Å—Ç–≤–∏—è (–∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é, –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å). –¢–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 2: –î–æ–±–∞–≤–ª—è–µ–º Function Calling –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π

–î–æ–±–∞–≤–∏–ª –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ Function Calling API:

```python
class ActionableTradingChat:
    """
    –ß–∞—Ç —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π.
    """
    def __init__(self, api_key: str, db_path: str, trading_api):
        self.client = openai.OpenAI(api_key=api_key)
        self.db_path = db_path
        self.trading_api = trading_api  # API –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
        self.conversation_history = []

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        self.available_functions = {
            'close_position': self.close_position,
            'modify_stop_loss': self.modify_stop_loss,
            'modify_take_profit': self.modify_take_profit,
            'get_position_details': self.get_position_details,
            'cancel_pending_orders': self.cancel_pending_orders
        }

    def close_position(self, symbol: str, reason: str = None) -> Dict:
        """
        –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É.
        """
        try:
            result = self.trading_api.close_position(symbol)
            return {
                'success': True,
                'message': f'–ü–æ–∑–∏—Ü–∏—è {symbol} –∑–∞–∫—Ä—ã—Ç–∞',
                'pnl': result.get('pnl', 0),
                'reason': reason
            }
        except Exception as e:
            return {
                'success': False,
                'error': str(e)
            }

    def modify_stop_loss(self, symbol: str, new_stop_loss: float) -> Dict:
        """
        –ò–∑–º–µ–Ω—è–µ—Ç —Å—Ç–æ–ø-–ª–æ—Å—Å –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏.
        """
        try:
            self.trading_api.modify_stop_loss(symbol, new_stop_loss)
            return {
                'success': True,
                'message': f'–°—Ç–æ–ø-–ª–æ—Å—Å –¥–ª—è {symbol} –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ {new_stop_loss}'
            }
        except Exception as e:
            return {'success': False, 'error': str(e)}

    def modify_take_profit(self, symbol: str, new_take_profit: float) -> Dict:
        """
        –ò–∑–º–µ–Ω—è–µ—Ç —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏.
        """
        try:
            self.trading_api.modify_take_profit(symbol, new_take_profit)
            return {
                'success': True,
                'message': f'–¢–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç –¥–ª—è {symbol} –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ {new_take_profit}'
            }
        except Exception as e:
            return {'success': False, 'error': str(e)}

    def get_position_details(self, symbol: str) -> Dict:
        """
        –ü–æ–ª—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–∑–∏—Ü–∏–∏.
        """
        positions = self.get_positions()
        position = next((p for p in positions if p['symbol'] == symbol), None)

        if not position:
            return {'error': f'–ü–æ–∑–∏—Ü–∏—è {symbol} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}

        # –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        position['risk_reward_ratio'] = self._calculate_rr(position)
        position['time_in_position'] = self._calculate_time_in_position(position)

        return position

    def _calculate_rr(self, position: Dict) -> float:
        """–í—ã—á–∏—Å–ª—è–µ—Ç Risk/Reward ratio."""
        # –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Ä–∞—Å—á—ë—Ç
        return 2.5  # –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî —Å–ª–æ–∂–Ω–µ–µ

    def _calculate_time_in_position(self, position: Dict) -> str:
        """–í—ã—á–∏—Å–ª—è–µ—Ç –≤—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏."""
        opened = pd.to_datetime(position['opened_at'])
        duration = datetime.now() - opened
        hours = duration.total_seconds() / 3600
        return f"{hours:.1f} hours"

    def cancel_pending_orders(self, symbol: str = None) -> Dict:
        """
        –û—Ç–º–µ–Ω—è–µ—Ç pending –æ—Ä–¥–µ—Ä–∞.
        """
        try:
            count = self.trading_api.cancel_pending_orders(symbol)
            return {
                'success': True,
                'message': f'–û—Ç–º–µ–Ω–µ–Ω–æ –æ—Ä–¥–µ—Ä–æ–≤: {count}',
                'symbol': symbol or 'all'
            }
        except Exception as e:
            return {'success': False, 'error': str(e)}

    def ask(self, question: str) -> str:
        """
        –ó–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π function calling.
        """
        # –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–∫—Å—Ç
        context = self.create_context(question)

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è API
        functions = [
            {
                'name': 'close_position',
                'description': '–ó–∞–∫—Ä—ã–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—É—é –ø–æ–∑–∏—Ü–∏—é –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É',
                'parameters': {
                    'type': 'object',
                    'properties': {
                        'symbol': {
                            'type': 'string',
                            'description': '–¢–∏–∫–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, AAPL, TSLA, ES)'
                        },
                        'reason': {
                            'type': 'string',
                            'description': '–ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏'
                        }
                    },
                    'required': ['symbol']
                }
            },
            {
                'name': 'modify_stop_loss',
                'description': '–ò–∑–º–µ–Ω—è–µ—Ç —Å—Ç–æ–ø-–ª–æ—Å—Å –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏',
                'parameters': {
                    'type': 'object',
                    'properties': {
                        'symbol': {'type': 'string', 'description': '–¢–∏–∫–µ—Ä'},
                        'new_stop_loss': {'type': 'number', 'description': '–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç–æ–ø-–ª–æ—Å—Å–∞'}
                    },
                    'required': ['symbol', 'new_stop_loss']
                }
            },
            {
                'name': 'modify_take_profit',
                'description': '–ò–∑–º–µ–Ω—è–µ—Ç —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏',
                'parameters': {
                    'type': 'object',
                    'properties': {
                        'symbol': {'type': 'string', 'description': '–¢–∏–∫–µ—Ä'},
                        'new_take_profit': {'type': 'number', 'description': '–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞'}
                    },
                    'required': ['symbol', 'new_take_profit']
                }
            },
            {
                'name': 'get_position_details',
                'description': '–ü–æ–ª—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏',
                'parameters': {
                    'type': 'object',
                    'properties': {
                        'symbol': {'type': 'string', 'description': '–¢–∏–∫–µ—Ä'}
                    },
                    'required': ['symbol']
                }
            },
            {
                'name': 'cancel_pending_orders',
                'description': '–û—Ç–º–µ–Ω—è–µ—Ç pending –æ—Ä–¥–µ—Ä–∞',
                'parameters': {
                    'type': 'object',
                    'properties': {
                        'symbol': {
                            'type': 'string',
                            'description': '–¢–∏–∫–µ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω ‚Äî –æ—Ç–º–µ–Ω—è–µ—Ç –≤—Å–µ)'
                        }
                    }
                }
            }
        ]

        # –ó–∞–ø—Ä–æ—Å –∫ OpenAI —Å function calling
        response = self.client.chat.completions.create(
            model="gpt-4",
            messages=[
                {'role': 'system', 'content': '–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π. –ú–æ–∂–µ—à—å –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–π—Å—Ç–≤–∏—è.'},
                {'role': 'user', 'content': context}
            ],
            functions=functions,
            function_call='auto',
            temperature=0.3
        )

        message = response.choices[0].message

        # –ï—Å–ª–∏ LLM —Ö–æ—á–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
        if message.function_call:
            function_name = message.function_call.name
            function_args = json.loads(message.function_call.arguments)

            print(f"[LLM –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é: {function_name}({function_args})]")

            # –í—ã–ø–æ–ª–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é
            function_to_call = self.available_functions[function_name]
            function_result = function_to_call(**function_args)

            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ LLM
            second_response = self.client.chat.completions.create(
                model="gpt-4",
                messages=[
                    {'role': 'system', 'content': '–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π.'},
                    {'role': 'user', 'content': context},
                    {
                        'role': 'function',
                        'name': function_name,
                        'content': json.dumps(function_result, ensure_ascii=False)
                    }
                ],
                temperature=0.3
            )

            return second_response.choices[0].message.content

        # –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω—ã–π –æ—Ç–≤–µ—Ç
        return message.content


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
if __name__ == "__main__":
    from mock_trading_api import MockTradingAPI  # –ú–æ–∫ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞

    trading_api = MockTradingAPI()
    chat = ActionableTradingChat(
        api_key="sk-...",
        db_path="./data",
        trading_api=trading_api
    )

    # –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥
    commands = [
        "–ó–∞–∫—Ä–æ–π –ø–æ–∑–∏—Ü–∏—é TSLA, –æ–Ω–∞ –≤ —É–±—ã—Ç–∫–µ",
        "–ü–µ—Ä–µ–¥–≤–∏–Ω—å —Å—Ç–æ–ø-–ª–æ—Å—Å –¥–ª—è AAPL –Ω–∞ 180",
        "–ü–æ–∫–∞–∂–∏ –¥–µ—Ç–∞–ª–∏ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ ES",
        "–û—Ç–º–µ–Ω–∏ –≤—Å–µ pending –æ—Ä–¥–µ—Ä–∞"
    ]

    for cmd in commands:
        print(f"\n–ö–æ–º–∞–Ω–¥–∞: {cmd}")
        answer = chat.ask(cmd)
        print(f"–û—Ç–≤–µ—Ç: {answer}")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—É—Å–∫–∞:**

```
–ö–æ–º–∞–Ω–¥–∞: –ó–∞–∫—Ä–æ–π –ø–æ–∑–∏—Ü–∏—é TSLA, –æ–Ω–∞ –≤ —É–±—ã—Ç–∫–µ
[LLM –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é: close_position({'symbol': 'TSLA', 'reason': '—É–±—ã—Ç–æ–∫'})]
–û—Ç–≤–µ—Ç: –ü–æ–∑–∏—Ü–∏—è TSLA –∑–∞–∫—Ä—ã—Ç–∞ —Å —É–±—ã—Ç–∫–æ–º -$85. –ü—Ä–∏—á–∏–Ω–∞: —É–±—ã—Ç–æ–∫. –≠—Ç–æ –±—ã–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–µ—Ä–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –∫–∞–ø–∏—Ç–∞–ª–∞.

–ö–æ–º–∞–Ω–¥–∞: –ü–µ—Ä–µ–¥–≤–∏–Ω—å —Å—Ç–æ–ø-–ª–æ—Å—Å –¥–ª—è AAPL –Ω–∞ 180
[LLM –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é: modify_stop_loss({'symbol': 'AAPL', 'new_stop_loss': 180.0})]
–û—Ç–≤–µ—Ç: –°—Ç–æ–ø-–ª–æ—Å—Å –¥–ª—è AAPL –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ $180. –¢–µ–ø–µ—Ä—å –ø–æ–∑–∏—Ü–∏—è –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è –Ω–∏–∂–µ —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è. –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: $182.90, –ø—Ä–∏–±—ã–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.

–ö–æ–º–∞–Ω–¥–∞: –ü–æ–∫–∞–∂–∏ –¥–µ—Ç–∞–ª–∏ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ ES
[LLM –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é: get_position_details({'symbol': 'ES'})]
–û—Ç–≤–µ—Ç: –ü–æ–∑–∏—Ü–∏—è ES (—Ñ—å—é—á–µ—Ä—Å S&P 500):
‚Ä¢ –°—Ç–æ—Ä–æ–Ω–∞: Long, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: 2 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
‚Ä¢ –í—Ö–æ–¥: 5420.50, —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: 5420.50
‚Ä¢ P&L: $0 (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
‚Ä¢ Risk/Reward ratio: 2.5
‚Ä¢ –í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏: 0.3 —á–∞—Å–∞ (18 –º–∏–Ω—É—Ç)
‚Ä¢ –°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è

–ö–æ–º–∞–Ω–¥–∞: –û—Ç–º–µ–Ω–∏ –≤—Å–µ pending –æ—Ä–¥–µ—Ä–∞
[LLM –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é: cancel_pending_orders({})]
–û—Ç–≤–µ—Ç: –í—Å–µ pending –æ—Ä–¥–µ—Ä–∞ –æ—Ç–º–µ–Ω–µ–Ω—ã. –í—Å–µ–≥–æ –æ—Ç–º–µ–Ω–µ–Ω–æ: 3 –æ—Ä–¥–µ—Ä–∞. –¢–µ–ø–µ—Ä—å —É –≤–∞—Å —Ç–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –±–µ–∑ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫.
```

**–í–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è:**
- LLM –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–Ω–∏–º–∞–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥: –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å "–ó–∞–∫—Ä–æ–π TSLA" –∏–ª–∏ "–ü—Ä–æ–¥–∞–π TSLA" ‚Äî LLM –ø–æ–Ω–∏–º–∞–µ—Ç
- **–í–ê–ñ–ù–û:** –î–æ–±–∞–≤–∏–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π (–æ–± —ç—Ç–æ–º –Ω–∏–∂–µ)

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–ø–∞—Å–Ω–æ –¥–∞–≤–∞—Ç—å LLM –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ç–æ—Ä–≥–æ–≤—ã–º –∫–æ–º–∞–Ω–¥–∞–º –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 3: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π

–î–æ–±–∞–≤–∏–ª —Å–∏—Å—Ç–µ–º—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:

```python
class SafeTradingChat(ActionableTradingChat):
    """
    –ß–∞—Ç —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π.
    """
    def __init__(self, api_key: str, db_path: str, trading_api, require_confirmation: bool = True):
        super().__init__(api_key, db_path, trading_api)
        self.require_confirmation = require_confirmation
        self.pending_action = None

    def is_critical_action(self, function_name: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º.
        """
        critical_actions = [
            'close_position',
            'modify_stop_loss',
            'modify_take_profit',
            'cancel_pending_orders'
        ]
        return function_name in critical_actions

    def ask_with_confirmation(self, question: str, confirm: bool = False) -> str:
        """
        –ó–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
        """
        # –ï—Å–ª–∏ –µ—Å—Ç—å –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏ –ø—Ä–∏—à–ª–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        if confirm and self.pending_action:
            function_name = self.pending_action['function_name']
            function_args = self.pending_action['args']

            print(f"[–í—ã–ø–æ–ª–Ω—è—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: {function_name}]")

            # –í—ã–ø–æ–ª–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é
            function_to_call = self.available_functions[function_name]
            result = function_to_call(**function_args)

            # –û—á–∏—â–∞–µ–º pending
            self.pending_action = None

            return f"‚úì –î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: {result['message']}"

        # –ï—Å–ª–∏ –ø—Ä–∏—à—ë–ª –æ—Ç–∫–∞–∑
        if not confirm and self.pending_action:
            self.pending_action = None
            return "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ."

        # –û–±—ã—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å
        context = self.create_context(question)

        functions = [...]  # –¢–µ –∂–µ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ –≤—ã—à–µ

        response = self.client.chat.completions.create(
            model="gpt-4",
            messages=[
                {'role': 'system', 'content': '–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π.'},
                {'role': 'user', 'content': context}
            ],
            functions=functions,
            function_call='auto',
            temperature=0.3
        )

        message = response.choices[0].message

        # –ï—Å–ª–∏ LLM —Ö–æ—á–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
        if message.function_call:
            function_name = message.function_call.name
            function_args = json.loads(message.function_call.arguments)

            # –ï—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
            if self.require_confirmation and self.is_critical_action(function_name):
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
                self.pending_action = {
                    'function_name': function_name,
                    'args': function_args
                }

                # –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                confirmation_message = f"""‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:

–î–µ–π—Å—Ç–≤–∏–µ: {function_name}
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: {json.dumps(function_args, ensure_ascii=False, indent=2)}

–í—ã —É–≤–µ—Ä–µ–Ω—ã? –û—Ç–ø—Ä–∞–≤—å—Ç–µ '–¥–∞' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ '–Ω–µ—Ç' –¥–ª—è –æ—Ç–º–µ–Ω—ã."""

                return confirmation_message

            # –ï—Å–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –≤—ã–ø–æ–ª–Ω—è–µ–º —Å—Ä–∞–∑—É
            function_to_call = self.available_functions[function_name]
            result = function_to_call(**function_args)

            return f"‚úì {result['message']}"

        return message.content


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
if __name__ == "__main__":
    chat = SafeTradingChat(
        api_key="sk-...",
        db_path="./data",
        trading_api=MockTradingAPI(),
        require_confirmation=True
    )

    # –î–∏–∞–ª–æ–≥ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
    print("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ó–∞–∫—Ä–æ–π –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏")
    response = chat.ask_with_confirmation("–ó–∞–∫—Ä–æ–π –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏")
    print(f"–ë–æ—Ç: {response}")

    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç
    print("\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –¥–∞")
    response = chat.ask_with_confirmation("–¥–∞", confirm=True)
    print(f"–ë–æ—Ç: {response}")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ó–∞–∫—Ä–æ–π –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏
–ë–æ—Ç: ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:

–î–µ–π—Å—Ç–≤–∏–µ: close_all_positions
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: {}

–í—ã —É–≤–µ—Ä–µ–Ω—ã? –û—Ç–ø—Ä–∞–≤—å—Ç–µ '–¥–∞' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ '–Ω–µ—Ç' –¥–ª—è –æ—Ç–º–µ–Ω—ã.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –¥–∞
[–í—ã–ø–æ–ª–Ω—è—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: close_all_positions]
–ë–æ—Ç: ‚úì –î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: –ó–∞–∫—Ä—ã—Ç–æ 3 –ø–æ–∑–∏—Ü–∏–∏. –û–±—â–∏–π P&L: +$355
```

–¢–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–Ω–æ!

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram

–°–æ–∑–¥–∞–ª Telegram-–±–æ—Ç–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —á–∞—Ç—É –∏–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ:

```python
import telebot
from telebot import types
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)


class TelegramTradingBot:
    """
    Telegram-–±–æ—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.
    """
    def __init__(self, telegram_token: str, openai_api_key: str,
                 db_path: str, trading_api):
        self.bot = telebot.TeleBot(telegram_token)
        self.chat_engine = SafeTradingChat(openai_api_key, db_path, trading_api)

        # –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        self.user_states = {}

        # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        self.register_handlers()

    def register_handlers(self):
        """
        –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥.
        """
        @self.bot.message_handler(commands=['start', 'help'])
        def send_welcome(message):
            welcome_text = """üëã –ü—Ä–∏–≤–µ—Ç! –Ø AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Ç–≤–æ–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.

–Ø –º–æ–≥—É:
‚Ä¢ –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏
‚Ä¢ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–∫–∏
‚Ä¢ –ó–∞–∫—Ä—ã—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)
‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
‚Ä¢ –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏

–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ –≤–æ–ø—Ä–æ—Å –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ!

–ü—Ä–∏–º–µ—Ä—ã:
üìä "–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –º–æ–∏–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏?"
üí∞ "–°–∫–æ–ª—å–∫–æ —è –∑–∞—Ä–∞–±–æ—Ç–∞–ª –∑–∞ –Ω–µ–¥–µ–ª—é?"
üîí "–ó–∞–∫—Ä–æ–π –ø–æ–∑–∏—Ü–∏—é TSLA"
üìà "–ü–æ–∫–∞–∂–∏ –ª—É—á—à—É—é —Å–¥–µ–ª–∫—É —Å–µ–≥–æ–¥–Ω—è"
"""
            self.bot.reply_to(message, welcome_text)

        @self.bot.message_handler(commands=['positions'])
        def show_positions(message):
            """–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø–æ–∑–∏—Ü–∏–π."""
            response = self.chat_engine.ask("–ü–æ–∫–∞–∂–∏ –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏")
            self.bot.reply_to(message, response)

        @self.bot.message_handler(commands=['pnl'])
        def show_pnl(message):
            """–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è P&L."""
            response = self.chat_engine.ask("–ü–æ–∫–∞–∂–∏ –ø—Ä–∏–±—ã–ª—å –∏ —É–±—ã—Ç–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è")
            self.bot.reply_to(message, response)

        @self.bot.message_handler(commands=['status'])
        def show_status(message):
            """–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã."""
            response = self.chat_engine.ask("–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã")
            self.bot.reply_to(message, response)

        @self.bot.message_handler(func=lambda message: True)
        def handle_message(message):
            """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è."""
            user_id = message.from_user.id
            text = message.text.strip()

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–ª–∏ –æ—Ç–º–µ–Ω–∞
            if text.lower() in ['–¥–∞', 'yes', '–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é', '–æ–∫']:
                if self.chat_engine.pending_action:
                    response = self.chat_engine.ask_with_confirmation(text, confirm=True)
                    self.bot.reply_to(message, response)
                else:
                    self.bot.reply_to(message, "–ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π, –æ–∂–∏–¥–∞—é—â–∏—Ö –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.")
                return

            if text.lower() in ['–Ω–µ—Ç', 'no', '–æ—Ç–º–µ–Ω–∞', 'cancel']:
                if self.chat_engine.pending_action:
                    response = self.chat_engine.ask_with_confirmation(text, confirm=False)
                    self.bot.reply_to(message, response)
                else:
                    self.bot.reply_to(message, "–ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –æ—Ç–º–µ–Ω—ã.")
                return

            # –û–±—ã—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å
            try:
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –±–æ—Ç –ø–µ—á–∞—Ç–∞–µ—Ç
                self.bot.send_chat_action(message.chat.id, 'typing')

                # –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç LLM
                response = self.chat_engine.ask_with_confirmation(text)

                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç
                self.bot.reply_to(message, response)

            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
                self.bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {str(e)}")

    def run(self):
        """
        –ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞.
        """
        logger.info("Telegram-–±–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
        self.bot.polling(none_stop=True)


# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
if __name__ == "__main__":
    bot = TelegramTradingBot(
        telegram_token="YOUR_TELEGRAM_BOT_TOKEN",
        openai_api_key="sk-...",
        db_path="./data",
        trading_api=MockTradingAPI()
    )

    bot.run()
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Telegram:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /start
–ë–æ—Ç: üëã –ü—Ä–∏–≤–µ—Ç! –Ø AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Ç–≤–æ–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã...

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?
–ë–æ—Ç: –£ –≤–∞—Å 3 –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏:
‚Ä¢ AAPL: +$440 (–ª–æ–Ω–≥, –ø—Ä–∏–±—ã–ª—å —Ä–∞—Å—Ç—ë—Ç)
‚Ä¢ TSLA: -$85 (—à–æ—Ä—Ç, –Ω–µ–±–æ–ª—å—à–æ–π —É–±—ã—Ç–æ–∫)
‚Ä¢ ES: $0 (–ª–æ–Ω–≥, –∂–¥—ë—Ç –¥–≤–∏–∂–µ–Ω–∏—è)

–û–±—â–∏–π P&L —Å–µ–≥–æ–¥–Ω—è: +$312 (12 —Å–¥–µ–ª–æ–∫, –≤–∏–Ω—Ä–µ–π—Ç 67%)
–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –æ—à–∏–±–æ–∫ –Ω–µ—Ç.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ó–∞–∫—Ä–æ–π TSLA
–ë–æ—Ç: ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:

–î–µ–π—Å—Ç–≤–∏–µ: close_position
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: {
  "symbol": "TSLA",
  "reason": "–ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
}

–í—ã —É–≤–µ—Ä–µ–Ω—ã? –û—Ç–ø—Ä–∞–≤—å—Ç–µ '–¥–∞' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ '–Ω–µ—Ç' –¥–ª—è –æ—Ç–º–µ–Ω—ã.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –¥–∞
–ë–æ—Ç: ‚úì –î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: –ü–æ–∑–∏—Ü–∏—è TSLA –∑–∞–∫—Ä—ã—Ç–∞ —Å —É–±—ã—Ç–∫–æ–º -$85

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /pnl
–ë–æ—Ç: –ü—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è:
üí∞ –û–±—â–∏–π P&L: +$227
üìä –°–¥–µ–ª–æ–∫: 13
‚úÖ –í–∏–Ω—Ä–µ–π—Ç: 69% (9 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö, 4 —É–±—ã—Ç–æ—á–Ω—ã—Ö)
üìà –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: +$52
üìâ –°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫: -$64
üèÜ –õ—É—á—à–∞—è —Å–¥–µ–ª–∫–∞: +$125 (AAPL)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –∏–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ Telegram
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 2-5 —Å–µ–∫—É–Ω–¥
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ
- –ú–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–∑–∏—Ü–∏—è–º–∏ –∏–∑ –ª—é–±–æ–π —Ç–æ—á–∫–∏ –º–∏—Ä–∞

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 5: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –∞–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–î–æ–±–∞–≤–∏–ª –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

```python
class AdvancedTradingChat(SafeTradingChat):
    """
    –ß–∞—Ç —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.
    """
    def __init__(self, api_key: str, db_path: str, trading_api):
        super().__init__(api_key, db_path, trading_api)

        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        self.available_functions.update({
            'analyze_risk': self.analyze_risk,
            'suggest_actions': self.suggest_actions,
            'backtest_idea': self.backtest_idea,
            'compare_strategies': self.compare_strategies
        })

    def analyze_risk(self) -> Dict:
        """
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–∏–π —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è.
        """
        positions = self.get_positions()
        total_exposure = sum([abs(p['pnl']) for p in positions])
        total_capital = 100000  # –ò–∑ –∫–æ–Ω—Ñ–∏–≥–∞

        risk_metrics = {
            'total_exposure': total_exposure,
            'exposure_percent': (total_exposure / total_capital) * 100,
            'max_single_position_risk': max([abs(p['pnl']) for p in positions] or [0]),
            'num_positions': len(positions),
            'diversification_score': len(set([p['symbol'] for p in positions])) / max(len(positions), 1)
        }

        # –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞
        if risk_metrics['exposure_percent'] > 20:
            risk_metrics['assessment'] = '–í–´–°–û–ö–ò–ô –†–ò–°–ö'
            risk_metrics['recommendation'] = '–°–Ω–∏–∑—å—Ç–µ —ç–∫—Å–ø–æ–∑–∏—Ü–∏—é –¥–æ 15%'
        elif risk_metrics['exposure_percent'] > 10:
            risk_metrics['assessment'] = '–°–†–ï–î–ù–ò–ô –†–ò–°–ö'
            risk_metrics['recommendation'] = '–†–∏—Å–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã, –Ω–æ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Å–∏—Ç—É–∞—Ü–∏–µ–π'
        else:
            risk_metrics['assessment'] = '–ù–ò–ó–ö–ò–ô –†–ò–°–ö'
            risk_metrics['recommendation'] = '–ú–æ–∂–µ—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ö–æ—Ä–æ—à–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤'

        return risk_metrics

    def suggest_actions(self) -> Dict:
        """
        –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞.
        """
        positions = self.get_positions()
        trades_df = pd.read_csv(f"{self.db_path}/trades.csv", parse_dates=['timestamp'])

        suggestions = []

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∑–∏—Ü–∏–∏ –≤ —É–±—ã—Ç–∫–µ > 2%
        for pos in positions:
            loss_percent = (pos['pnl'] / (pos['entry_price'] * pos['quantity'])) * 100
            if loss_percent < -2:
                suggestions.append({
                    'type': 'warning',
                    'action': f"–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∑–∞–∫—Ä—ã—Ç–∏–µ {pos['symbol']}",
                    'reason': f"–£–±—ã—Ç–æ–∫ {loss_percent:.1f}% (${pos['pnl']:.2f})"
                })

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∑–∏—Ü–∏–∏ —Å –ø—Ä–∏–±—ã–ª—å—é > 5%
        for pos in positions:
            profit_percent = (pos['pnl'] / (pos['entry_price'] * pos['quantity'])) * 100
            if profit_percent > 5:
                suggestions.append({
                    'type': 'opportunity',
                    'action': f"–ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ —á–∞—Å—Ç–∏—á–Ω—É—é –ø—Ä–∏–±—ã–ª—å –ø–æ {pos['symbol']}",
                    'reason': f"–ü—Ä–∏–±—ã–ª—å {profit_percent:.1f}% (${pos['pnl']:.2f})"
                })

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–Ω—Ä–µ–π—Ç –ø–æ —Å–∏–º–≤–æ–ª–∞–º
        symbol_stats = trades_df.groupby('symbol').agg({
            'pnl': ['count', 'sum', lambda x: (x > 0).mean()]
        }).reset_index()
        symbol_stats.columns = ['symbol', 'num_trades', 'total_pnl', 'win_rate']

        for _, row in symbol_stats.iterrows():
            if row['num_trades'] >= 5 and row['win_rate'] < 0.4:
                suggestions.append({
                    'type': 'warning',
                    'action': f"–ò–∑–±–µ–≥–∞–π—Ç–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ {row['symbol']}",
                    'reason': f"–ù–∏–∑–∫–∏–π –≤–∏–Ω—Ä–µ–π—Ç {row['win_rate']*100:.0f}% –∑–∞ {row['num_trades']} —Å–¥–µ–ª–æ–∫"
                })

        return {'suggestions': suggestions, 'count': len(suggestions)}

    def backtest_idea(self, idea: str) -> Dict:
        """
        –ë—ã—Å—Ç—Ä—ã–π –±—ç–∫—Ç–µ—Å—Ç –∏–¥–µ–∏ (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è).
        """
        # –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –∑–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –±—ç–∫—Ç–µ—Å—Ç–∞
        # –ó–¥–µ—Å—å ‚Äî –º–æ–∫ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        return {
            'idea': idea,
            'sharpe_ratio': 1.45,
            'total_return': 23.5,
            'max_drawdown': -8.2,
            'win_rate': 0.62,
            'num_trades': 156,
            'verdict': '–ò–¥–µ—è –≤—ã–≥–ª—è–¥–∏—Ç –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–æ. –†–µ–∫–æ–º–µ–Ω–¥—É—é –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.'
        }

    def compare_strategies(self, strategy_a: str, strategy_b: str) -> Dict:
        """
        –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –¥–≤–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
        """
        # –ú–æ–∫ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        return {
            'strategy_a': {
                'name': strategy_a,
                'sharpe': 1.45,
                'return': 23.5,
                'drawdown': -8.2
            },
            'strategy_b': {
                'name': strategy_b,
                'sharpe': 1.12,
                'return': 18.3,
                'drawdown': -12.5
            },
            'winner': strategy_a,
            'reason': f'{strategy_a} –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–π Sharpe Ratio –∏ –º–µ–Ω—å—à–∏–π –ø—Ä–æ—Å–∞–¥–∫—É'
        }


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
if __name__ == "__main__":
    chat = AdvancedTradingChat(
        api_key="sk-...",
        db_path="./data",
        trading_api=MockTradingAPI()
    )

    questions = [
        "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –º–æ–π —Ç–µ–∫—É—â–∏–π —Ä–∏—Å–∫",
        "–ß—Ç–æ –º–Ω–µ —Å–¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å?",
        "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –∏–¥–µ—é: –ø–æ–∫—É–ø–∫–∞ –Ω–∞ –ø—Ä–æ–±–æ–µ 20-–¥–Ω–µ–≤–Ω–æ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞",
        "–°—Ä–∞–≤–Ω–∏ –º–æ—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é RSI —Å MACD –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–æ–º"
    ]

    for q in questions:
        print(f"\n–í–æ–ø—Ä–æ—Å: {q}")
        answer = chat.ask(q)
        print(f"–û—Ç–≤–µ—Ç: {answer}\n")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

```
–í–æ–ø—Ä–æ—Å: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –º–æ–π —Ç–µ–∫—É—â–∏–π —Ä–∏—Å–∫
–û—Ç–≤–µ—Ç: –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è:

üìä –û–±—â–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è: $355 (0.36% –æ—Ç –∫–∞–ø–∏—Ç–∞–ª–∞ $100K)
üéØ –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: –ù–ò–ó–ö–ò–ô –†–ò–°–ö
üìà –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é: $440 (AAPL)
üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π: 2 (–ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è TSLA)
üåà –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: 100% (–∫–∞–∂–¥–∞—è –ø–æ–∑–∏—Ü–∏—è ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∞–∫—Ç–∏–≤)

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ú–æ–∂–µ—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ö–æ—Ä–æ—à–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤. –†–∏—Å–∫ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π.

–í–æ–ø—Ä–æ—Å: –ß—Ç–æ –º–Ω–µ —Å–¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å?
–û—Ç–≤–µ—Ç: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏:

‚úÖ –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ —á–∞—Å—Ç–∏—á–Ω—É—é –ø—Ä–∏–±—ã–ª—å –ø–æ AAPL
   –ü—Ä–∏—á–∏–Ω–∞: –ü—Ä–∏–±—ã–ª—å 24.6% ($440). –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–æ–¥–∞–∂—É –ø–æ–ª–æ–≤–∏–Ω—ã –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ø—Ä–∏–±—ã–ª–∏.

‚ö†Ô∏è –ò–∑–±–µ–≥–∞–π—Ç–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ TSLA
   –ü—Ä–∏—á–∏–Ω–∞: –ù–∏–∑–∫–∏–π –≤–∏–Ω—Ä–µ–π—Ç 35% –∑–∞ 12 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–¥–µ–ª–æ–∫.

–û–±—â–∏–π —Å–æ–≤–µ—Ç: –ü–æ—Ä—Ç—Ñ–µ–ª—å –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ–¥–æ–∂–¥–∞—Ç—å –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–π.

–í–æ–ø—Ä–æ—Å: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –∏–¥–µ—é: –ø–æ–∫—É–ø–∫–∞ –Ω–∞ –ø—Ä–æ–±–æ–µ 20-–¥–Ω–µ–≤–Ω–æ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞
–û—Ç–≤–µ—Ç: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ã—Å—Ç—Ä–æ–≥–æ –±—ç–∫—Ç–µ—Å—Ç–∞ –∏–¥–µ–∏ "–ø–æ–∫—É–ø–∫–∞ –Ω–∞ –ø—Ä–æ–±–æ–µ 20-–¥–Ω–µ–≤–Ω–æ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞":

üìä Sharpe Ratio: 1.45
üí∞ –û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: +23.5%
üìâ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞: -8.2%
‚úÖ –í–∏–Ω—Ä–µ–π—Ç: 62%
üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫: 156

–í–µ—Ä–¥–∏–∫—Ç: –ò–¥–µ—è –≤—ã–≥–ª—è–¥–∏—Ç –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–æ. –†–µ–∫–æ–º–µ–Ω–¥—É—é –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–í–æ–ø—Ä–æ—Å: –°—Ä–∞–≤–Ω–∏ –º–æ—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é RSI —Å MACD –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–æ–º
–û—Ç–≤–µ—Ç: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π:

üìà RSI Strategy:
   ‚Ä¢ Sharpe Ratio: 1.45
   ‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: +23.5%
   ‚Ä¢ –ü—Ä–æ—Å–∞–¥–∫–∞: -8.2%

üìâ MACD Crossover:
   ‚Ä¢ Sharpe Ratio: 1.12
   ‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: +18.3%
   ‚Ä¢ –ü—Ä–æ—Å–∞–¥–∫–∞: -12.5%

üèÜ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å: RSI Strategy

–ü—Ä–∏—á–∏–Ω–∞: RSI Strategy –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–π Sharpe Ratio (1.45 vs 1.12) –∏ –º–µ–Ω—å—à—É—é –ø—Ä–æ—Å–∞–¥–∫—É (-8.2% vs -12.5%). –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RSI.
```

–¢–µ–ø–µ—Ä—å —á–∞—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –Ω–æ –∏ –¥–∞—ë—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏!

## –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ —á—Ç–æ –Ω–µ—Ç

| –§—É–Ω–∫—Ü–∏—è | –†–∞–±–æ—Ç–∞–µ—Ç? | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----------|-------------|
| **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∑–∏—Ü–∏—è—Ö** | ‚úÖ –î–∞ | –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø, —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| **–†–∞—Å—á—ë—Ç P&L –∏ –º–µ—Ç—Ä–∏–∫** | ‚úÖ –î–∞ | LLM –æ—Ç–ª–∏—á–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ü–∏—Ñ—Ä—ã |
| **–ó–∞–∫—Ä—ã—Ç–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π** | ‚úÖ –î–∞ | –° –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ |
| **–ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤** | ‚úÖ –î–∞ | –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
| **Suggestions (—á—Ç–æ –¥–µ–ª–∞—Ç—å)** | ‚úÖ –î–∞ | –≠–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram** | ‚úÖ –î–∞ | –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ |
| **–ë—ç–∫—Ç–µ—Å—Ç –∏–¥–µ–π —á–µ—Ä–µ–∑ —á–∞—Ç** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –±—ç–∫—Ç–µ—Å—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ª–Ω—ã–π —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞ |
| **–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤** | ‚úÖ –î–∞ | LLM –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –Ω–∞–º–µ—Ä–µ–Ω–∏—è |
| **–†–∞–±–æ—Ç–∞ —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏** | ‚úÖ –î–∞ | –ú–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—à–ª—ã–µ –ø–µ—Ä–∏–æ–¥—ã |
| **–†–µ–∞–ª-—Ç–∞–π–º –∞–ª–µ—Ä—Ç—ã** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | –¢—Ä–µ–±—É–µ—Ç webhook –∏–ª–∏ polling |
| **–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥** | ‚ùå –ù–µ—Ç | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ Whisper API) |

## –†–µ–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ 3 –Ω–µ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ LLM-—á–∞—Ç–∞ | –° LLM-—á–∞—Ç–æ–º | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-------------|-------------|-----------|
| **–í—Ä–µ–º—è —É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —á–µ–∫–∞–ø–∞** | 10-15 –º–∏–Ω—É—Ç | 30 —Å–µ–∫—É–Ω–¥ | **95%** |
| **–í—Ä–µ–º—è –Ω–∞ –∞–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤** | 20 –º–∏–Ω—É—Ç | 10 —Å–µ–∫—É–Ω–¥ | **99%** |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å** | 5-10 (—á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã) | 30-50 (—á–µ—Ä–µ–∑ —á–∞—Ç) | **400%** |
| **–í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã** | 30-60 –º–∏–Ω—É—Ç | 2-5 –º–∏–Ω—É—Ç | **90%** |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å API (OpenAI)** | $0 | $5-8/–º–µ—Å—è—Ü | –ü—Ä–∏–µ–º–ª–µ–º–æ |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö** | 2-3/–Ω–µ–¥–µ–ª—é | 0-1/–Ω–µ–¥–µ–ª—é | **70%** |
| **–£–¥–æ–±—Å—Ç–≤–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ –ø–æ–µ–∑–¥–∫–∞—Ö** | 3/10 (–Ω–µ—É–¥–æ–±–Ω–æ) | 9/10 (–æ—Ç–ª–∏—á–Ω–æ) | **200%** |

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: LLM –≥–∞–ª–ª—é—Ü–∏–Ω–∏—Ä—É–µ—Ç —Ü–∏—Ñ—Ä—ã

**–°–∏—Ç—É–∞—Ü–∏—è:** –ò–Ω–æ–≥–¥–∞ LLM –≤—ã–¥—É–º—ã–≤–∞–µ—Ç —Ü–∏—Ñ—Ä—ã, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.

–ü—Ä–∏–º–µ—Ä:
```
–í–æ–ø—Ä–æ—Å: –°–∫–æ–ª—å–∫–æ —è –∑–∞—Ä–∞–±–æ—Ç–∞–ª –∑–∞ –∏—é–Ω—å?
–û—Ç–≤–µ—Ç: –ó–∞ –∏—é–Ω—å –≤—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ $4,523.
```

(–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –±—ã–ª–æ $3,890)

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

```python
system_prompt = """–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Ç—Ä–µ–π–¥–µ—Ä–∞.

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
1. –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é
2. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –æ—Ç–≤–µ—Ç–∞, —Å–∫–∞–∂–∏ "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–≤–µ—Ç–∞"
3. –ù–ò–ö–û–ì–î–ê –Ω–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π —Ü–∏—Ñ—Ä—ã
4. –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü–æ –¥–∞–Ω–Ω—ã–º –Ω–∞ 2026-06-23 09:15...")

–ï—Å–ª–∏ —Ç—ã –Ω–µ —É–≤–µ—Ä–µ–Ω –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–∫–∞–∂–∏ –æ–± —ç—Ç–æ–º."""
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ: 0 –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –∑–∞ 3 –Ω–µ–¥–µ–ª–∏.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –í—ã—Å–æ–∫–∞—è –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–°–∏—Ç—É–∞—Ü–∏—è:** –ó–∞–ø—Ä–æ—Å—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (–≤—Å–µ —Ç—Ä–µ–π–¥—ã –∑–∞ –º–µ—Å—è—Ü) –∑–∞–Ω–∏–º–∞—é—Ç 10-15 —Å–µ–∫—É–Ω–¥.

**–†–µ—à–µ–Ω–∏–µ:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è:

```python
import functools
from datetime import datetime, timedelta

# –ö—ç—à –Ω–∞ 60 —Å–µ–∫—É–Ω–¥
@functools.lru_cache(maxsize=128)
def get_pnl_summary_cached(period: str, cache_key: int):
    # cache_key = int(datetime.now().timestamp() // 60)
    return get_pnl_summary(period)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
cache_key = int(datetime.now().timestamp() // 60)
pnl = get_pnl_summary_cached('today', cache_key)
```

–¢–µ–ø–µ—Ä—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞ –æ–¥–Ω—É –º–∏–Ω—É—Ç—É –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –°—Ç–æ–∏–º–æ—Å—Ç—å API —Ä–∞—Å—Ç—ë—Ç

**–°–∏—Ç—É–∞—Ü–∏—è:** –ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (50+ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å) —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–ª–∞ $15/–¥–µ–Ω—å.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∫–ª—é—á–∏–ª—Å—è –Ω–∞ Claude 3.5 Haiku –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–µ—à–µ–≤–ª–µ –≤ 15 —Ä–∞–∑):

```python
def choose_model(question: str, context: str) -> str:
    """
    –í—ã–±–∏—Ä–∞–µ—Ç –º–æ–¥–µ–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞.
    """
    # –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Ñ–∞–∫—Ç—ã) ‚Üí –¥–µ—à—ë–≤–∞—è –º–æ–¥–µ–ª—å
    simple_patterns = [
        '–ø–æ–∫–∞–∂–∏', '—Å–∫–æ–ª—å–∫–æ', '–∫–∞–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏', '—Å—Ç–∞—Ç—É—Å', '–µ—Å—Ç—å –ª–∏'
    ]

    if any(pattern in question.lower() for pattern in simple_patterns):
        return "claude-3-5-haiku-20241022"  # –î—ë—à–µ–≤–æ

    # –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∞–Ω–∞–ª–∏–∑, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏) ‚Üí –¥–æ—Ä–æ–≥–∞—è –º–æ–¥–µ–ª—å
    return "gpt-4"  # –î–æ—Ä–æ–≥–æ, –Ω–æ —Ç–æ—á–Ω–æ
```

–°—Ç–æ–∏–º–æ—Å—Ç—å —É–ø–∞–ª–∞ —Å $15/–¥–µ–Ω—å –¥–æ $3/–¥–µ–Ω—å –ø—Ä–∏ —Ç–æ–º –∂–µ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–æ–≤.

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞

**–°–∏—Ç—É–∞—Ü–∏—è:** Telegram-–±–æ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ª—é–±–æ–º—É, –∫—Ç–æ –∑–Ω–∞–µ—Ç —Ç–æ–∫–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏–ª whitelist –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```python
ALLOWED_USERS = [123456789, 987654321]  # Telegram user IDs

@bot.message_handler(func=lambda message: True)
def handle_message(message):
    if message.from_user.id not in ALLOWED_USERS:
        bot.reply_to(message, "‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω.")
        logger.warning(f"Unauthorized access attempt from {message.from_user.id}")
        return

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
    ...
```

–¢–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ —è –º–æ–≥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞.

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

```python
context = f"""–î–∞–Ω–Ω—ã–µ –Ω–∞ {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}:
..."""
```

–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç LLM –ø–æ–Ω–∏–º–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ structured output –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
# –í–º–µ—Å—Ç–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
response_format = {
    "type": "json_object",
    "schema": {
        "total_pnl": "number",
        "num_trades": "integer",
        "win_rate": "number"
    }
}
```

### 3. –õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è

```python
logger.info(f"User {user_id} executed: {function_name}({function_args})")
```

–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –∏ –∞—É–¥–∏—Ç–µ.

### 4. –î–æ–±–∞–≤—å—Ç–µ rate limiting

```python
from collections import defaultdict
from datetime import datetime, timedelta

user_requests = defaultdict(list)

def check_rate_limit(user_id: int, limit: int = 50) -> bool:
    now = datetime.now()
    one_hour_ago = now - timedelta(hours=1)

    # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã
    user_requests[user_id] = [
        req_time for req_time in user_requests[user_id]
        if req_time > one_hour_ago
    ]

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç
    if len(user_requests[user_id]) >= limit:
        return False

    user_requests[user_id].append(now)
    return True
```

### 5. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

```python
# –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —á–∞—Ç –Ω–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å
test_date = '2026-06-01'
df_test = df[df['date'] == test_date]
response = chat.ask("–ö–∞–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç—ã?")
assert validate_response(response, df_test)
```

## –í—ã–≤–æ–¥—ã

LLM-—á–∞—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —É–¥–æ–±—Å—Ç–≤–æ, –∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫ –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–µ–∞–∫—Ü–∏–∏ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏:

‚úÖ **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ª—é–±—ã–º –¥–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —è–∑—ã–∫
- –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (—ç–∫–æ–Ω–æ–º–∏—è 99% –≤—Ä–µ–º–µ–Ω–∏)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ —á–µ—Ä–µ–∑ Telegram –∏–∑ –ª—é–±–æ–π —Ç–æ—á–∫–∏ –º–∏—Ä–∞
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

‚ö†Ô∏è **–ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–∏—Ñ—Ä (LLM –º–æ–∂–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∏—Ä–æ–≤–∞—Ç—å)
- –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ API (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ—à—ë–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ (whitelist –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

‚ùå **–ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –±—ç–∫—Ç–µ—Å—Ç —á–µ—Ä–µ–∑ —á–∞—Ç (—Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞)
- –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ (–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ Whisper API)

**–ì–ª–∞–≤–Ω—ã–π –∏–Ω—Å–∞–π—Ç:** –ß–∞—Ç –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—Ä–≥–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∏–∑ "—á—ë—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞" –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–∏—Å–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∏ —Å—Ç—Ä–æ–∏—Ç—å –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞, —è –ø—Ä–æ—Å—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞—é –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ. –≠—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç 10-15 –º–∏–Ω—É—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –±—ã—Å—Ç—Ä–µ–µ.

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $3-8/–º–µ—Å—è—Ü –∑–∞ OpenAI API ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞.

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
- –î–æ–±–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ —á–µ—Ä–µ–∑ Whisper API
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª-—Ç–∞–π–º –∞–ª–µ—Ä—Ç–∞–º–∏ (webhook –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–æ–≤)
- –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å: –æ—Ç–ø—Ä–∞–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å –∞–Ω–∞–ª–∏–∑–æ–º
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∏–∞–ª–æ–≥–æ–≤ –≤ —Ç–æ—Ä–≥–æ–≤—ã–π –∂—É—Ä–Ω–∞–ª

---

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- [OSA Engine –Ω–∞ GitHub](https://github.com/[–≤–∞—à-—Ä–µ–ø–æ]/osa-engine)
- [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏–∑ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏](https://github.com/[–≤–∞—à-—Ä–µ–ø–æ]/osa-engine/tree/main/examples/llm-chat)
- [–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç–∞—Ç—å—è: –ò–ò –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏—á–µ–π]({{ site.baseurl }}{% post_url 2026-06-16-ai-dlya-ml-ficherov %})
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenAI Function Calling](https://platform.openai.com/docs/guides/function-calling)
- [python-telegram-bot –±–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://github.com/python-telegram-bot/python-telegram-bot)
