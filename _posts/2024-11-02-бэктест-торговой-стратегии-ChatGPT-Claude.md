---
layout: post
title: "Поиск торговой идеи с помощью ChatGPT и Claude: от данных до бэктеста"
description: "Рассмотрим, как можно использовать ИИ для анализа данных, поиска неэффективностей и создания торговой стратегии на примере криптовалютных минутных данных."
date: 2024-11-02
image: /assets/images/blog/ai-trading-strategy-preview.png
tags: [ChatGPT, Claude, Аналитика]
---

В этой статье я решил сравнить два популярных сервиса [ChatGPT](https://chatgpt.com/) и [Claude.ai](https://claude.ai/) и посмотреть, как они справляются с задачей поиска торговых неэффективностей на ноябрь 2024 года. Я оценил их функционал и удобство использования, чтобы выяснить, какой из них лучше подходит для анализа данных и разработки прибыльной торговой стратегии.

Чтобы упростить сбор данных, я воспользовался **[Гидрой](https://stocksharp.ru/store/%D1%81%D0%BA%D0%B0%D1%87%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85/)** — это, пожалуй, лучший бесплатный инструмент для загрузки рыночных данных.

Я скачал минутные данные по BTCUSDT за 2024 год, которые составили примерно 25 МБ, и выгрузил их в CSV-файл.

![](/assets/images/blog/hydra_2.png)

![](/assets/images/blog/hydra_3.png)

В Гидре есть и своя аналитика, но дальше вы увидите насколько это всё остало от возможностей ИИ, где не нужно даже писать код самому:

![](/assets/images/blog/hydra_4.png)

Однако главным этапом моей работы стал не сбор данных, а их анализ и поиск идей для стратегии. Вместо того чтобы вручную искать подходы, я решил довериться ИИ и узнать, какие стратегии он предложит, какие паттерны и неэффективности он сможет выявить в данных, и как оптимизировать параметры для тестирования. С помощью **ChatGPT** я смог не только провести подробный анализ, но и провести бэктест стратегии на данных.

---

### Подготовка данных

Получив минутные данные, я загрузил их в Python (код писал сам ИИ, я лишь печатал текстом что я от него требую) и начал с предобработки. Это включало назначение имен для каждого столбца и объединение даты и времени в единый столбец, чтобы упростить анализ временных рядов.

---

### Поиск неэффективностей с помощью ИИ

После предобработки данных я решил спросить ИИ о возможных неэффективностях и паттернах, которые могут быть полезны для разработки стратегии. ChatGPT предложил несколько подходов:

1. **Кластеры волатильности** — Часы с высокой волатильностью могли бы быть подходящими для импульсной стратегии.
2. **Склонность к возврату к среднему** — В моменты отклонения цены от среднего уровня можно использовать стратегию возврата к среднему.
3. **Импульсные паттерны** — В определенные часы наблюдалось устойчивое движение цены, что могло быть сигналом для трендовой стратегии.

![](/assets/images/blog/volatility-clusters.png)

---

### Разработка стратегии

На основе предложений ИИ я выбрал для тестирования две стратегии:

1. **Возврат к среднему (Mean Reversion)**: Открытие короткой позиции при сильном отклонении цены вверх от среднего значения и длинной — при отклонении вниз. Закрытие позиции — при возврате цены к среднему.
   
2. **Импульсная стратегия (Momentum)**: Открытие позиции в направлении тренда в моменты повышенной волатильности. Если доходность положительна и выше порога, позиция открывается на покупку, а если отрицательна и ниже порога — на продажу.

Для каждой стратегии были заданы базовые правила входа и выхода, а также стоп-лоссы для управления рисками.

![](/assets/images/blog/hourly-returns.png)

---

### Бэктестинг стратегий

С помощью ChatGPT я смог также выполнить бэктест обеих стратегий, чтобы увидеть, как они бы сработали на исторических данных. Результаты тестирования показали кривую доходности для стратегии возврата к среднему (см. график ниже). 

График показывает, как могла бы изменяться капитализация портфеля при следовании стратегии. Можно заметить, что стратегия демонстрировала стабильный рост в определенные периоды, однако также встречались моменты просадок. Это подтверждает важность настройки параметров и использования управления рисками.

![](/assets/images/blog/mean-reversion-equity-curve.png)

---

### Claude.ai

В процессе работы я также попытался использовать **Claude Sonnet** от Anthropic, который недавно анонсировал свой функционал анализа больших данных (подробнее [здесь](https://www.anthropic.com/news/analysis-tool)). Идея казалась многообещающей: загрузить файл размером 25 МБ, чтобы Claude мог помочь с анализом.

![](/assets/images/blog/claude_analytics.png)

Однако я столкнулся с рядом трудностей. К сожалению, функция оказалась сырой и недоработанной — мой файл даже не загружался. В итоге я порезал его на мелкие части, но из-за предыдущих ошибок быстро достиг лимита запросов. Всё, что мне удалось получить, — это ошибка при попытке построения графика.

![](/assets/images/blog/claude_error_1.png)

Хотя я люблю работать с Claude, надеюсь, что инженеры проекта доработают эту функцию и существенно расширят окно для загрузки данных. Это позволит более эффективно анализировать крупные файлы и открывать новые возможности для работы с большими объёмами информации.

![](/assets/images/blog/claude_error_2.png)

---

### Заключение

Использование ChatGPT позволило мне не просто провести анализ данных, но и задать вопросы ИИ о подходящих методах создания стратегии. Этот подход не только дал новые идеи, но и помог быстро протестировать гипотезы и получить рекомендации, которые могли бы остаться незамеченными при обычном подходе. Подход, при котором ИИ помогает искать идеи и параметры стратегии, открывает новые возможности для гибкой и адаптивной разработки торговых стратегий.
